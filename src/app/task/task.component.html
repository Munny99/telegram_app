<div class="min-h-screen bg-dark text-white">

  <!-- Main Content -->
  <main class="main-content">

    <!-- Stats Cards -->
    <div class="stats-grid" *ngIf="user">
      <div class="card">
        <div class="icon blue"><i class="bi bi-star-fill"></i></div>
        <div>
          <p class="value">{{ userRating }}</p>
          <p class="label">‡¶∞‡ßá‡¶ü‡¶ø‡¶Ç</p>
        </div>
      </div>

      <div class="card">
        <div class="icon purple"><i class="bi bi-camera-reels-fill"></i></div>
        <div>
          <p class="value">{{ userSessions }}+</p>
          <p class="label">‡¶∏‡ßá‡¶∂‡¶®</p>
        </div>
      </div>

      <div class="card">
        <div class="icon green"><i class="bi bi-award-fill"></i></div>
        <div>
          <p class="value">‡¶ü‡¶™ {{ user.rating }}</p>
          <p class="label">‡¶è‡¶ï‡ßç‡¶∏‡¶™‡¶æ‡¶∞‡ßç‡¶ü</p>
        </div>
      </div>
    </div>

    <!-- Error Message -->
    <div class="error-alert" *ngIf="errorMessage">
      <i class="bi bi-exclamation-triangle-fill"></i>
      {{ errorMessage }}
    </div>

    <!-- Loading State -->
    <div class="loading-box" *ngIf="loading">
      <div class="spinner"></div>
      <p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
    </div>

    <!-- Daily Task Progress -->
    <div class="call-history">
      <div class="call-header">
        <h2>‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø</h2>
        <span>{{ dailyTasksCompleted }} / {{ dailyTaskLimit }}</span>
      </div>
      <div class="call-box">
        <i class="bi bi-clock-history"></i>
        <p>‡¶Ü‡¶ú {{ dailyTaskLimit - dailyTasksCompleted }}‡¶ü‡¶ø ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶Ü‡¶õ‡ßá</p>
      </div>
    </div>

    <!-- Video Ad Task (First available custom link task) -->
    <div class="call-card" *ngIf="videoAdTasks.length > 0">
      <div class="content" *ngFor="let task of videoAdTasks.slice(0, 1)">
        <div class="circle">
          <i class="bi bi-camera-video-fill"></i>
        </div>
        <h2>{{ task.taskTitle }}</h2>
        <p>{{ task.taskDescription }}</p>
        <div class="earning">
          <span>üíµ ‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°:</span>
          <strong>{{ task.rewardAmount.toFixed(2) }} TAKA</strong>
        </div>
        <button
          class="main-btn"
          (click)="startTask(task)"
          [disabled]="isProcessing(task.id)">
          <i class="bi bi-play-circle-fill"></i>
          {{ isProcessing(task.id) ? '‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç...' : '‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®' }}
        </button>
        <button
          class="verify-btn"
          (click)="verifyTask(task)"
          [disabled]="isProcessing(task.id)">
          <i class="bi bi-patch-check-fill"></i>
          {{ isProcessing(task.id) ? '‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...' : '‡¶ö‡ßá‡¶ï ‡¶ì ‡¶ï‡ßç‡¶≤‡ßá‡¶á‡¶Æ' }}
        </button>
      </div>
    </div>

    <!-- Telegram Channels -->
    <div class="telegram-section">
      <div *ngFor="let task of telegramTasks; trackBy: trackByTaskId" class="telegram-card">
        <div class="telegram-content">
          <div class="telegram-icon">
            <i class="bi bi-telegram"></i>
          </div>

          <h3>{{ task.taskTitle }}</h3>
          <p>{{ task.taskDescription }}</p>

          <div class="reward">
            <span>üéÅ</span>
            <span>‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°: {{ task.rewardAmount.toFixed(2) }} TAKA</span>
          </div>

          <div class="verification-badge" *ngIf="task.requiresVerification">
            <i class="bi bi-shield-check"></i> ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á‡¶ï‡¶∞‡¶£
          </div>

          <div class="button-group">
            <button
              class="btn-secondary"
              (click)="startTask(task)"
              [disabled]="isProcessing(task.id)">
              <i class="bi bi-box-arrow-up-right"></i>
              {{ isProcessing(task.id) ? '‡¶ñ‡ßã‡¶≤‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...' : '‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂' }}
            </button>
            <button
              class="btn-primary"
              (click)="verifyTask(task)"
              [disabled]="isProcessing(task.id)">
              <i class="bi bi-patch-check-fill"></i>
              {{ isProcessing(task.id) ? '‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶π‡¶ö‡ßç‡¶õ‡ßá...' : '‡¶ö‡ßá‡¶ï ‡¶ì ‡¶ï‡ßç‡¶≤‡ßá‡¶á‡¶Æ' }}
            </button>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div class="empty-state" *ngIf="!loading && telegramTasks.length === 0">
        <i class="bi bi-inbox"></i>
        <p>‡¶ï‡ßã‡¶® ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶®‡ßá‡¶á</p>
      </div>
    </div>

    <!-- Stats Summary -->
    <div class="task-card" *ngIf="user">
      <div class="stats-summary">
        <div class="stat-item">
          <i class="bi bi-clock-history text-sky-400"></i>
          <div>
            <p class="stat-label">‡¶Ü‡¶ú‡¶ï‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®</p>
            <p class="stat-value">{{ dailyTasksCompleted }} ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</p>
          </div>
        </div>
        <div class="stat-item">
          <i class="bi bi-cash-coin text-green-400"></i>
          <div>
            <p class="stat-label">‡¶Æ‡ßã‡¶ü ‡¶Ü‡¶Ø‡¶º</p>
            <p class="stat-value earnings">{{ pendingBalance }} ‡ß≥</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Referral Section -->
    <div class="referral-section" *ngIf="user">
      <div class="referral-card-bangla">
        <h3>üì£ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ú‡¶æ‡¶®‡¶æ‡¶®</h3>
        <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶ï‡ßã‡¶° ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!</p>
        <div class="referral-code-box">
          <span class="referral-code">{{ user.referralCode }}</span>
          <button class="btn-share" (click)="shareReferral()">
            <i class="bi bi-share-fill"></i> ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
          </button>
        </div>
        <div class="referral-stats">
          <div class="ref-stat">
            <span class="ref-count">{{ user.totalReferrals }}</span>
            <span class="ref-label">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Completed Tasks -->
    <div class="completed-section" *ngIf="completedTasks.length > 0">
      <h2 class="section-title">
        <i class="bi bi-check-circle-fill"></i> ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï
      </h2>
      <div class="completed-list">
        <div *ngFor="let task of completedTasks; trackBy: trackByTaskId" class="completed-item">
          <div class="completed-icon">
            <i [class]="getTaskIcon(task.taskType)"></i>
          </div>
          <div class="completed-info">
            <h4>{{ task.taskTitle }}</h4>
            <span class="completed-reward">+{{ task.rewardAmount.toFixed(2) }} TAKA</span>
          </div>
          <i class="bi bi-check-circle-fill completed-check"></i>
        </div>
      </div>
    </div>

  </main>

</div>